# ABIF Metadata Specification

This document describes metadata fields processed and generated by abiflib for election method specification, data processing, and election information.

## Field list
An alphabetical list of metadata fields that one may see in an ABIF file.

- **`ballot_type`**: The format of ballot presented to voters (see below)
- **`ballotcount`**: Total number of ballots processed (see below)
- **`ballotcount_abif_metadata`**: Original ballot count from ABIF metadata (if different from calculated)
- **`comments`**: Array of comment tuples (line_number, comment_text) when `storecomments=True`
- **`contestid`**: Numeric identifier for specific contest within multi-contest elections
- **`description`**: Detailed description of the election context and background
- **`emptyballotcount`**: Number of empty/blank ballots
- **`filename`**: Source filename for the election data
- **`is_ranking_to_rating`**: Boolean flag indicating that ranked ballots were converted to ratings (triggers conversion notices)
- **`max_rating`**: Maximum rating/score value for rated ballots (e.g., 5 for STAR's 0-5 scale, 1 for approval)
- **`tally_method`**: The method used to determine the winner(s) of the election.
- **`title`**: Human-readable election title (e.g., "2009 Burlington mayoral election")
- **`version`**: ABIF format version (e.g., "0.1")

## Field details
An incomplete list of entries providing more details about the fields listed above (sorted alphabetically).

### `ballotcount` ###
`ballotcount` may be included in files from other sources, but is automatically generated by abiftool if it is missing.  If it is included in the ABIF file, then `ballotcount_abif_metadata` may also be added to the metadata.

### `ballot_type`
Describes the type of ballot format used:

- `{ballot_type: "choose_many"}` - Multi-choice ballots (used in
  Approval, Block, and Cumulative voting, among others)
- `{ballot_type: "choose_one"}` - Single-choice ballots (FPTP/plurality)
- `{ballot_type: "ranked"}` - Ranked choice ballots (preference order)
- `{ballot_type: "rated"}` - Rated/scored ballots (numerical scores)  

### `tally_method` 
Specifies how ballots are counted/tallied:

- `{tally_method: "approval"}` - Approval voting
- `{tally_method: "Borda"}` - Borda count (not yet fully implemented)
- `{tally_method: "pairwise"}` - Condorcet/Copeland
- `{tally_method: "FPTP"}` - First Past The Post
- `{tally_method: "IRV"}` - Instant Runoff Voting
- `{tally_method: "score"}` - Score voting
- `{tally_method: "STAR"}` - STAR voting (a.k.a. "Score Then Automatic Runoff")

## Implementation Notes

No metadata fields are required in ABIF files.  Some fields are
automatically set by abiflib during processing:

- `ballotcount` is recalculated from voteline quantities, and 
- `is_ranking_to_rating` is set when STAR/score methods process ranked ballots
- `filename` may be set by HTML output generators
